---
import BaseLayout from "@layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const title = "Projets — Sabbahi Sonia";
const description = "Sélection de projets en développement web, applications métiers et interfaces modernes.";

// On lit la collection "projets" (dossier src/content/projets)
const rawProjets = await getCollection("projets");

// Tri du plus récent au plus ancien (par la clé "date" du frontmatter)
const projets = rawProjets.sort((a, b) => {
  const da = new Date(a.data.date);
  const db = new Date(b.data.date);
  return db.getTime() - da.getTime();
});
---

<BaseLayout {title} {description}>
  <section class="py-16 md:py-24 max-w-4xl mx-auto px-4 space-y-12">

    <!-- TITRE -->
    <div class="space-y-4 text-center">
      <h1 class="text-4xl font-bold">Mes projets</h1>
      <p class="text-lg opacity-80 max-w-2xl mx-auto">
        Une sélection de projets réalisés en formation, en freelance ou en autonomie.
        Chaque projet reflète ma façon de concevoir des interfaces utiles, lisibles et modernes.
      </p>
    </div>

    <!-- LISTE DES PROJETS -->
    <div class="space-y-4">
      {projets.map((projet) => (
        <a
          href={`/projets/${projet.slug}`}
          class="block card-smooth p-5 space-y-3"
        >
          <div class="flex items-start justify-between gap-3">
            <div class="space-y-1">
              <h2 class="text-lg font-semibold">
                {projet.data.title}
              </h2>
              {projet.data.subtitle && (
                <p class="text-sm opacity-80">
                  {projet.data.subtitle}
                </p>
              )}
            </div>

            {projet.data.date && (
              <p class="text-xs opacity-60 whitespace-nowrap">
                {new Date(projet.data.date).toLocaleDateString("fr-FR", {
                  year: "numeric",
                  month: "short",
                })}
              </p>
            )}
          </div>

          {projet.data.description && (
            <p class="text-sm opacity-80">
              {projet.data.description}
            </p>
          )}

          {projet.data.tech && Array.isArray(projet.data.tech) && (
            <div class="flex flex-wrap gap-2 pt-1">
              {projet.data.tech.map((t) => (
                <span class="inline-flex items-center rounded-full border border-neutral-300/60 dark:border-neutral-700/60 px-2.5 py-0.5 text-[11px] uppercase tracking-wide opacity-80">
                  {t}
                </span>
              ))}
            </div>
          )}
        </a>
      ))}
    </div>

  </section>
</BaseLayout>



